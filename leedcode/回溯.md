# å›æº¯ç®—æ³•ï¼ˆBack Tracking)

[TOC]

## 1ã€æ¦‚å¿µ

**å›æº¯æ³•ï¼ˆback trackingï¼‰**ï¼ˆæ¢ç´¢ä¸å›æº¯æ³•ï¼‰æ˜¯ä¸€ç§é€‰ä¼˜æœç´¢æ³•ï¼Œåˆç§°ä¸ºè¯•æ¢æ³•ï¼ŒæŒ‰é€‰ä¼˜æ¡ä»¶å‘å‰æœç´¢ï¼Œä»¥è¾¾åˆ°ç›®æ ‡ã€‚ä½†å½“æ¢ç´¢åˆ°æŸä¸€æ­¥æ—¶ï¼Œå‘ç°åŸå…ˆé€‰æ‹©å¹¶ä¸ä¼˜æˆ–è¾¾ä¸åˆ°ç›®æ ‡ï¼Œå°±é€€å›ä¸€æ­¥é‡æ–°é€‰æ‹©ï¼Œè¿™ç§èµ°ä¸é€šå°±é€€å›å†èµ°çš„æŠ€æœ¯ä¸ºå›æº¯æ³•ï¼Œè€Œæ»¡è¶³å›æº¯æ¡ä»¶çš„æŸä¸ªçŠ¶æ€çš„ç‚¹ç§°ä¸ºâ€œå›æº¯ç‚¹â€ã€‚

> å›æº¯æ³•å¯ä»¥ç†è§£ä¸ºé€šè¿‡é€‰æ‹©ä¸åŒçš„å²”è·¯å£å¯»æ‰¾ç›®çš„åœ°ï¼Œä¸€ä¸ªå²”è·¯å£ä¸€ä¸ªå²”è·¯å£çš„å»å°è¯•æ‰¾åˆ°ç›®çš„åœ°ã€‚å¦‚æœèµ°é”™äº†è·¯ï¼Œç»§ç»­è¿”å›æ¥æ‰¾åˆ°å²”è·¯å£çš„å¦ä¸€æ¡è·¯ï¼Œç›´åˆ°æ‰¾åˆ°ç›®çš„åœ°ã€‚

## 2ã€åŸºæœ¬æ€æƒ³

 	  åœ¨åŒ…å«é—®é¢˜çš„æ‰€æœ‰è§£çš„è§£ç©ºé—´æ ‘ä¸­ï¼ŒæŒ‰ç…§æ·±åº¦ä¼˜å…ˆæœç´¢çš„ç­–ç•¥ï¼Œä»æ ¹ç»“ç‚¹å‡ºå‘æ·±åº¦æ¢ç´¢è§£ç©ºé—´æ ‘ã€‚å½“æ¢ç´¢åˆ°æŸä¸€ç»“ç‚¹æ—¶ï¼Œè¦å…ˆåˆ¤æ–­è¯¥ç»“ç‚¹æ˜¯å¦åŒ…å«é—®é¢˜çš„è§£ï¼Œå¦‚æœåŒ…å«ï¼Œå°±ä»è¯¥ç»“ç‚¹å‡ºå‘ç»§ç»­æ¢ç´¢ä¸‹å»ï¼Œå¦‚æœè¯¥ç»“ç‚¹ä¸åŒ…å«é—®é¢˜çš„è§£ï¼Œåˆ™é€å±‚å‘å…¶ç¥–å…ˆç»“ç‚¹å›æº¯ã€‚ï¼ˆå…¶å®å›æº¯æ³•å°±æ˜¯å¯¹éšå¼å›¾çš„**æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•**ï¼‰ã€‚
       è‹¥ç”¨å›æº¯æ³•æ±‚é—®é¢˜çš„**æ‰€æœ‰è§£**æ—¶ï¼Œè¦å›æº¯åˆ°æ ¹ï¼Œä¸”æ ¹ç»“ç‚¹çš„æ‰€æœ‰å¯è¡Œçš„å­æ ‘éƒ½è¦å·²è¢«**æœç´¢é**æ‰ç»“æŸã€‚
       è€Œè‹¥ä½¿ç”¨å›æº¯æ³•æ±‚ä»»ä¸€ä¸ªè§£æ—¶ï¼Œåªè¦æœç´¢åˆ°é—®é¢˜çš„ä¸€ä¸ªè§£å°±å¯ä»¥ç»“æŸã€‚

## 3ã€ç”¨å›æº¯æ³•è§£é¢˜çš„ä¸€èˆ¬æ­¥éª¤ï¼š
â€‹    ï¼ˆ1ï¼‰é’ˆå¯¹æ‰€ç»™é—®é¢˜ï¼Œç¡®å®šé—®é¢˜çš„è§£ç©ºé—´ï¼š
â€‹            é¦–å…ˆåº”æ˜ç¡®å®šä¹‰é—®é¢˜çš„è§£ç©ºé—´ï¼Œé—®é¢˜çš„è§£ç©ºé—´åº”è‡³å°‘åŒ…å«é—®é¢˜çš„ä¸€ä¸ªï¼ˆæœ€ä¼˜ï¼‰è§£ã€‚
â€‹    ï¼ˆ2ï¼‰ç¡®å®šç»“ç‚¹çš„æ‰©å±•æœç´¢è§„åˆ™
â€‹    ï¼ˆ3ï¼‰ä»¥æ·±åº¦ä¼˜å…ˆæ–¹å¼æœç´¢è§£ç©ºé—´ï¼Œå¹¶åœ¨æœç´¢è¿‡ç¨‹ä¸­ç”¨å‰ªæå‡½æ•°é¿å…æ— æ•ˆæœç´¢ã€‚

## 4ã€ç®—æ³•æ¡†æ¶

     ### ï¼ˆ1ï¼‰é—®é¢˜æ¡†æ¶

â€‹      è®¾é—®é¢˜çš„è§£æ˜¯ä¸€ä¸ªnç»´å‘é‡(a1, a2,â€¦â€¦â€¦,an),çº¦æŸæ¡ä»¶æ˜¯ ai(i=1,2,3,â€¦..,n)ä¹‹é—´æ»¡è¶³æŸç§æ¡ä»¶ï¼Œè®°ä¸ºf(ai)ã€‚

   ### ï¼ˆ2ï¼‰è¿­ä»£å›æº¯æ¡†æ¶

```C
void IterativeBackTrace(void) {
    int t = 1;
    while(t>0) {
        if(f(n, t) <= g( n, t))
            for(int i = f(n, t); i <= g(n, t); i++ ) {
                x[t] = h(i);
                if(Constraint(t) && Bound(t)) {
                    if ( Solution(t))
                        Output(x);
                    else
                        t++;
                }
            }
            else tâˆ’âˆ’;
    }
}
```

### ï¼ˆ3ï¼‰é€’å½’çš„ç®—æ³•æ¡†æ¶
â€‹     å›æº¯æ³•æ˜¯å¯¹è§£ç©ºé—´çš„æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨é€’å½’å‡½æ•°æ¥å®ç°å›æº¯æ³•æ¯”è¾ƒç®€å•ã€‚å…¶ä¸­ï¼Œ`t` è¡¨ç¤ºé€’å½’æ·±åº¦ï¼Œå³å½“å‰æ‰©å±•ç»“ç‚¹åœ¨è§£ç©ºé—´æ ‘ä¸­çš„æ·±åº¦ï¼›`n` ç”¨æ¥æ§åˆ¶é€’å½’æ·±åº¦ï¼Œå³è§£ç©ºé—´æ ‘çš„é«˜åº¦ã€‚å½“` t>n`æ—¶ï¼Œç®—æ³•å·²æœç´¢åˆ°ä¸€ä¸ªå¶å­ç»“ç‚¹ï¼Œæ­¤æ—¶ç”±å‡½æ•°`Output(x)`å¯¹å¾—åˆ°çš„å¯è¡Œè§£`x`è¿›è¡Œè®°å½•æˆ–è¾“å‡ºå¤„ç†ã€‚

```C
void BackTrace(int t) {
    if(t>n)
        Output(x);
    else
        for(int i = f (n, t); i <= g (n, t); i++ ) {
            x[t] = h(i);
            if(Constraint(t) && Bound (t))
                BackTrace(t+1);
        }
}
```

## 5ã€å®ä¾‹

### å…«çš‡åé—®é¢˜

å…«çš‡åé—®é¢˜æ˜¯ä¸€ä¸ªå¤è€è€Œè‘—åçš„é—®é¢˜ï¼Œæ˜¯å›æº¯ç®—æ³•çš„å…¸å‹ä¾‹é¢˜ã€‚è¯¥é—®é¢˜æ˜¯åä¹ä¸–çºªè‘—åçš„æ•°å­¦å®¶é«˜æ–¯1850å¹´æå‡ºï¼šåœ¨8 X 8æ ¼çš„å›½é™…è±¡æ£‹ä¸Šæ‘†æ”¾å…«ä¸ªçš‡åï¼ˆ**æ£‹å­**ï¼‰ï¼Œä½¿å…¶ä¸èƒ½äº’ç›¸æ”»å‡»ï¼Œå³ä»»æ„ä¸¤ä¸ªçš‡åéƒ½ä¸èƒ½å¤„äºåŒä¸€è¡Œã€åŒä¸€åˆ—æˆ–åŒä¸€æ–œçº¿ä¸Šã€‚

> ç†è§£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå›æº¯æ³•çš„ç²¾é«“å·²ç»getã€‚å¦‚æœåªæ˜¯æƒ³äº†è§£ç®—æ³•é¢è¯•çŸ¥è¯†ï¼ŒçŸ¥é“è§£å†³è¿™ä¸ªé—®é¢˜å°±èƒ½å®Œæˆä½ çš„ç®—æ³•ç§¯ç´¯äº†ã€‚**æƒ³å¿«é€ŸæŒæ¡ç®—æ³•ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹è§£é¢˜æ€è·¯çš„å››ä¸ªæ­¥éª¤**ã€‚

**step 1**
å°è¯•å…ˆæ”¾ç½®ç¬¬ä¸€æšçš‡åï¼Œè¢«æ¶‚é»‘çš„åœ°æ–¹æ˜¯ä¸èƒ½æ”¾çš‡å

![img](https://pic3.zhimg.com/80/v2-bde25f03b5a86cc6ca47ee03fd171c9e_1440w.jpg)

**step 2**
ç¬¬äºŒè¡Œçš„çš‡ååªèƒ½æ”¾åœ¨ç¬¬ä¸‰æ ¼æˆ–ç¬¬å››æ ¼ï¼Œæ¯”æ–¹æˆ‘ä»¬æ”¾ç¬¬ä¸‰æ ¼ï¼Œåˆ™ï¼š

> æ­¤æ—¶æˆ‘ä»¬ä¹Ÿèƒ½ç†è§£ä¸ºä»€ä¹ˆå«çš‡åé—®é¢˜äº†ï¼Œçš‡åæ—è¾¹å®¹ä¸ä¸‹å…¶ä»–çš‡åã€‚è€Œåœ¨åŒä¸€ä¸ªæˆ¿é—´æ”¾ä¸‹å››ä¸ªçš‡åç¡®å®æ˜¯ä¸ªä¸å®¹æ˜“çš„é—®é¢˜ã€‚

![img](https://pic2.zhimg.com/80/v2-40654679a56af2cd9282b9ae60d4c641_1440w.jpg)

**step 3**
å¯ä»¥çœ‹åˆ°å†éš¾ä»¥æ”¾ä¸‹ç¬¬ä¸‰ä¸ªçš‡åï¼Œæ­¤æ—¶æˆ‘ä»¬å°±è¦ç”¨åˆ°**å›æº¯**ç®—æ³•äº†ã€‚æˆ‘ä»¬æŠŠç¬¬äºŒä¸ªçš‡åæ›´æ”¹ä½ç½®ï¼Œæ­¤æ—¶æˆ‘ä»¬èƒ½æ”¾ä¸‹ç¬¬ä¸‰æšçš‡åäº†ã€‚

![img](https://pic1.zhimg.com/80/v2-b810b81e8843c11e30e62277ddde1b4c_1440w.jpg)

**step 4**
è™½ç„¶æ˜¯èƒ½æ”¾ç½®ç¬¬ä¸‰ä¸ªçš‡åï¼Œä½†æ˜¯ç¬¬å››ä¸ªçš‡ååˆæ— è·¯å¯èµ°äº†ã€‚è¿”å›ä¸Šå±‚è°ƒç”¨ï¼ˆ3å·çš‡åï¼‰ï¼Œè€Œ3å·ä¹Ÿåˆ«æ— å¯å»ï¼Œç»§ç»­å›æº¯ä¸Šå±‚è°ƒç”¨ï¼ˆ2å·ï¼‰ï¼Œ2å·å·²ç„¶æ— è·¯å¯å»ï¼Œç»§ç»­å›æº¯ä¸Šå±‚ï¼ˆ1å·ï¼‰ï¼Œäºæ˜¯1å·çš‡åæ”¹å˜ä½ç½®å¦‚ä¸‹ï¼Œç»§ç»­å›æº¯ã€‚

![img](https://pic2.zhimg.com/80/v2-a22c5c4152b4b8b488555be294837f39_1440w.jpg)

è¿™å°±æ˜¯å›æº¯ç®—æ³•çš„ç²¾é«“ï¼Œè™½ç„¶æ²¡æœ‰æœ€ç»ˆæŠŠé—®é¢˜è§£å†³ï¼Œä½†æ˜¯å¯ä»¥å‰§é€ä¸€æ³¢ï¼Œå°±æ˜¯æ ¹æ®è¿™ä¸ªç®—æ³•ï¼Œæœ€ç»ˆèƒ½å¤ŸæŠŠå››ä½çš‡åæ”¾åœ¨4 x 4çš„æ£‹ç›˜é‡Œã€‚ä¹Ÿèƒ½ç”¨åŒæ ·çš„æ–¹æ³•è§£å†³äº†å…«çš‡åé—®é¢˜ã€‚ä¸‹é¢æˆ‘ä»¬ç”¨ä»£ç è§£å†³å…«çš‡åé—®é¢˜ã€‚

#### ä»£ç å®ç°å…«çš‡åé—®é¢˜

æˆ‘ä»¬å°†ç®—æ³•ä¹Ÿè®¾ç½®æˆä¸¤æ­¥ï¼Œ
**ç¬¬ä¸€æ­¥** æˆ‘ä»¬è¦åˆ¤æ–­æ¯æ¬¡è¾“å…¥çš„çš‡åæ˜¯å¦åœ¨åŒä¸€è¡ŒåŒä¸€åˆ—ï¼Œæˆ–è€…åŒä¸€æ–œçº¿ä¸Šã€‚

```C
bool is_ok(int row){            //åˆ¤æ–­è®¾ç½®çš„çš‡åæ˜¯å¦åœ¨åŒä¸€è¡Œï¼ŒåŒä¸€åˆ—ï¼Œæˆ–è€…åŒä¸€æ–œçº¿ä¸Š
    for (int j=0;j<row;j++)
    {
        if (queen[row]==queen[j]||row-queen[row]==j-queen[j]||row+queen[row]==j+queen[j])
            return false;       
    }
    return true;
}
```

**ç¬¬äºŒæ­¥** å¥—ç”¨ç®—æ³•æ¡†æ¶

```C
void back_tracking(int row=0)    //ç®—æ³•å‡½æ•°ï¼Œä»ç¬¬0è¡Œå¼€å§‹éå†
{
    if (row==n)
        t ++;               //åˆ¤æ–­è‹¥éå†å®Œæˆï¼Œå°±è¿›è¡Œè®¡æ•°     
     for (int col=0;col<n;col++)     //éå†æ£‹ç›˜æ¯ä¸€åˆ—
     {
          queen[row] = col;           //å°†çš‡åçš„ä½ç½®è®°å½•åœ¨æ•°ç»„
          if (is_ok(row))             //åˆ¤æ–­çš‡åçš„ä½ç½®æ˜¯å¦æœ‰å†²çª
             back_tracking(row+1);   //é€’å½’ï¼Œè®¡ç®—ä¸‹ä¸€ä¸ªçš‡åçš„ä½ç½®
     }
}
```

ä¹Ÿæ˜¯ä¸ªä¼ªä»£ç ğŸ¥±

## 6ã€leetcode

åŠ›æ‰£å›æº¯ç®—æ³•é¢˜ç›®ï¼š10ï¼Œ17ï¼Œ22ï¼Œ37ï¼Œ39ï¼Œ40ï¼Œ44ï¼Œ46ï¼Œ47ï¼Œ51ï¼Œ52ï¼Œ60

10ï¼š

```java
class Solution {

    //å­˜æ”¾æœ€ç»ˆç»“æœ
    List<String> res = new ArrayList<>();

    //å­˜æ”¾ä¸´æ—¶ç»“æœ
    StringBuffer path = new StringBuffer();

    //ä½¿ç”¨HashMapå­˜æ”¾å­—ç¬¦ä¸å­—ç¬¦ä¸²å¯¹åº”å…³ç³»
    Map<Character,String> phoneMap = new HashMap<>(){{
        put('2', "abc");
        put('3', "def");
        put('4', "ghi");
        put('5', "jkl");
        put('6', "mno");
        put('7', "pqrs");
        put('8', "tuv");
        put('9', "wxyz");
    }};
    
    public List<String> letterCombinations(String digits) {

        //å¯¹è¾“å…¥è¿›è¡Œåˆ¤æ–­
        if(digits.length() == 0){
            return res;
        }

        //å›æº¯
        backtraking(digits,0);

        //è¿”å›ç»“æœ
        return res;
    }
    /**å‚æ•°ï¼šindexï¼šâ€œ23â€ä¸­çš„ç´¢å¼•*/
    public void backtraking(String digits,int index){

        //ç»ˆæ­¢æ¡ä»¶ï¼š"abc"éå†å®Œæˆã€‚
        if(index == digits.length()){
            res.add(path.toString());
            return;
        }

        //è·å¾—indexå¯¹åº”çš„æ•°å­—
        char digit = digits.charAt(index);

        //è·å¾—æ•°å­—å¯¹åº”çš„å­—ç¬¦ä¸²
        String letter = phoneMap.get(digit);

        //éå†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦
        for(int i = 0;i < letter.length();i++){

            //å­˜å…¥
            path.append(letter.charAt(i));

            //é€’å½’
            backtraking(digits,index+1);

            //å›æº¯
            path.deleteCharAt(index);
        }
    }
}

```

